### CUDA入门及介绍

> author: liuxiao
>
> date:2020/08/05



#### CUDA介绍

**计算机同意设备架构(Computer Unified Device Architecture, CUDA)**是由英伟达（**NVIDIA**）开发的一套并行计算平台和编程模型。它只支持**NVIDIA GPU**显卡。OpenCL则用来为其他类型的GPU编写并行代码。



#### GPU架构和CUDA介绍

##### CPU和GPU硬件架构的区别

CPU具有复杂的控制硬件和较少的数据计算硬件。复杂的控制硬件在性能上提供了CPU的灵活性和一个简单的编程接口，但是就功耗而言这是昂贵的。GPU具有简单的控制硬件和更多的数据计算硬件，使其具有并行计算能力。这种结构使它更节能。但是它有一个更严格的编程模型。



#### CUDA架构

CUDA架构包括几个专门为GPU通用计算而设计的特性。它包括一个unified shedder管道，它允许GPU芯片上的所有**算术逻辑单元（ALU）**被一个CUDA程序编组。ALU还被设计成符合IEEE浮点单精度和双精度标准，因此它还可以用于通用应用程序。指令集也适合于一般用途的计算，而不是特定于像素计算。它还允许对内存的任意读写访问。

所有GPU都有许多被称为核心（Core）的并行处理单元。在硬件上这些核心被分为流处理器和流多处理器。GPU有这些流多处理器的网格。在软件方面，CUDA程序是作为一系列并行运行的多线程（Thread）来执行的。每个线程都在不同的核心上执行。可以将GPU看成多个块（Block）的组合，每个块可以执行多个线程。每个块绑定到GPU上的不同流多处理器。来自同一块的线程可以相互通信。

##### CUDA编程模型以及代码的执行

假如我们有一个由CPU和GPU组成的计算平台。CPU及其内存成为主机（Host）,GPU及其内存称为设备（Device）。CUDA代码（**主机和设备的代码**），主机代码由普通的C或C++编译器在CPU上编译，设备代码由GPU编译器在GPU上编译。主机代码通过所谓的内核调用调用设备代码。它将在设备上并行启动多个线程。在设备上启动多少个线程可以我们自己决定。

##### 设备代码

设备代码类似于正常的串行C代码。只是这段代码在大量内核上并行执行的。然而，要是这段代码工作，它需要设备现存上的数据。所以在启动线程之前，主机将数据从主机内存复制到设备显存。线程处理来自设备显存的数据，并将结果存储在设备显存中。最后将这些数据复制回主机内存进行进一步处理。所以，CUDA C程序开发步骤是：

1. **为主机和设备显存中的数据分配内存**。
2. **将数据从主机复制到设备显存**。
3. **通过指定并行度来启动内核。**
4. **所有线程完成后，将数据从设备显存复制回主机内存。**
5. **释放主机和设备上所有使用的内存**。



#### windows上配置CUDA开发环境

[链接](<https://github.com/lsmilesmile/skills/blob/master/CUDA%E7%BC%96%E7%A8%8B%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE.md>)

